# CareForAll Platform - Environment Configuration
# Copy this file to .env and update values as needed

# =============================================================================
# ENVIRONMENT
# =============================================================================
ENVIRONMENT=development
# Options: development, staging, production

# =============================================================================
# DATABASE CONFIGURATION (PostgreSQL)
# =============================================================================

# Donation Service Database
DONATION_DB_HOST=postgres
DONATION_DB_PORT=5432
DONATION_DB_NAME=donations_db
DONATION_DB_USER=postgres
DONATION_DB_PASSWORD=postgres
DONATION_DATABASE_URL=postgresql://postgres:postgres@postgres:5432/donations_db

# Payment Service Database
PAYMENT_DB_HOST=postgres
PAYMENT_DB_PORT=5432
PAYMENT_DB_NAME=payments_db
PAYMENT_DB_USER=postgres
PAYMENT_DB_PASSWORD=postgres
PAYMENT_DATABASE_URL=postgresql://postgres:postgres@postgres:5432/payments_db

# Totals Service Database
TOTALS_DB_HOST=postgres
TOTALS_DB_PORT=5432
TOTALS_DB_NAME=totals_db
TOTALS_DB_USER=postgres
TOTALS_DB_PASSWORD=postgres
TOTALS_DATABASE_URL=postgresql://postgres:postgres@postgres:5432/totals_db

# Notification Service Database
NOTIFICATION_DB_HOST=postgres
NOTIFICATION_DB_PORT=5432
NOTIFICATION_DB_NAME=notifications_db
NOTIFICATION_DB_USER=postgres
NOTIFICATION_DB_PASSWORD=postgres
NOTIFICATION_DATABASE_URL=postgresql://postgres:postgres@postgres:5432/notifications_db

# Database Connection Pool Settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=40
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_URL=redis://redis:6379/0

# Redis for Idempotency (Payment Service)
REDIS_IDEMPOTENCY_DB=1
REDIS_IDEMPOTENCY_URL=redis://redis:6379/1

# Redis for Caching (Totals Service)
REDIS_CACHE_DB=2
REDIS_CACHE_URL=redis://redis:6379/2

# Redis TTL Settings (seconds)
IDEMPOTENCY_TTL=86400
CACHE_TTL=300

# =============================================================================
# RABBITMQ CONFIGURATION
# =============================================================================
RABBITMQ_HOST=rabbitmq
RABBITMQ_PORT=5672
RABBITMQ_MANAGEMENT_PORT=15672
RABBITMQ_USER=guest
RABBITMQ_PASSWORD=guest
RABBITMQ_VHOST=/
RABBITMQ_URL=amqp://guest:guest@rabbitmq:5672/

# Queue Configuration
RABBITMQ_HEARTBEAT=60
RABBITMQ_BLOCKED_CONNECTION_TIMEOUT=300

# =============================================================================
# SERVICE PORTS
# =============================================================================
API_GATEWAY_PORT=8000
DONATION_SERVICE_PORT=8001
PAYMENT_SERVICE_PORT=8002
TOTALS_SERVICE_PORT=8003
NOTIFICATION_SERVICE_PORT=8004

# =============================================================================
# PAYMENT GATEWAY CONFIGURATION
# =============================================================================

# Stripe
STRIPE_API_KEY=sk_test_dummy_key_replace_in_production
STRIPE_PUBLISHABLE_KEY=pk_test_dummy_key_replace_in_production
STRIPE_WEBHOOK_SECRET=whsec_dummy_secret_replace_in_production
STRIPE_API_VERSION=2023-10-16

# PayPal (Optional)
PAYPAL_CLIENT_ID=your_paypal_client_id_here
PAYPAL_CLIENT_SECRET=your_paypal_client_secret_here
PAYPAL_MODE=sandbox
# Options: sandbox, live

# =============================================================================
# NOTIFICATION SERVICES
# =============================================================================

# Email Configuration (SendGrid)
SENDGRID_API_KEY=your_sendgrid_api_key_here
SENDGRID_FROM_EMAIL=noreply@careforall.org
SENDGRID_FROM_NAME=CareForAll Platform

# Email Configuration (AWS SES - Alternative)
AWS_SES_ACCESS_KEY_ID=your_aws_access_key_here
AWS_SES_SECRET_ACCESS_KEY=your_aws_secret_key_here
AWS_SES_REGION=us-east-1
AWS_SES_FROM_EMAIL=noreply@careforall.org

# SMS Configuration (Twilio)
TWILIO_ACCOUNT_SID=your_twilio_account_sid_here
TWILIO_AUTH_TOKEN=your_twilio_auth_token_here
TWILIO_PHONE_NUMBER=+1234567890

# Notification Settings
NOTIFICATION_RETRY_MAX_ATTEMPTS=3
NOTIFICATION_RETRY_BACKOFF=exponential

# =============================================================================
# OBSERVABILITY - OPENTELEMETRY
# =============================================================================

# Jaeger Configuration
JAEGER_AGENT_HOST=jaeger
JAEGER_AGENT_PORT=6831
JAEGER_COLLECTOR_ENDPOINT=http://jaeger:14268/api/traces
OTEL_EXPORTER_OTLP_ENDPOINT=http://jaeger:4317

# OpenTelemetry Settings
OTEL_SERVICE_NAME=careforall-platform
OTEL_TRACES_EXPORTER=otlp
OTEL_METRICS_EXPORTER=prometheus
OTEL_LOGS_EXPORTER=console

# Tracing Configuration
OTEL_TRACES_SAMPLER=always_on
OTEL_PROPAGATORS=tracecontext,baggage

# =============================================================================
# OBSERVABILITY - PROMETHEUS
# =============================================================================
PROMETHEUS_PORT=9090
PROMETHEUS_SCRAPE_INTERVAL=15s
PROMETHEUS_EVALUATION_INTERVAL=15s

# Metrics Export Settings
METRICS_PORT=9091
METRICS_PATH=/metrics

# =============================================================================
# OBSERVABILITY - GRAFANA
# =============================================================================
GRAFANA_PORT=3000
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin
# IMPORTANT: Change admin password in production!

GF_SECURITY_ADMIN_USER=admin
GF_SECURITY_ADMIN_PASSWORD=admin
GF_USERS_ALLOW_SIGN_UP=false
GF_SERVER_ROOT_URL=http://localhost:3000

# =============================================================================
# API GATEWAY (NGINX)
# =============================================================================
NGINX_WORKER_PROCESSES=auto
NGINX_WORKER_CONNECTIONS=1024
NGINX_KEEPALIVE_TIMEOUT=65

# Rate Limiting
NGINX_RATE_LIMIT=100r/s
NGINX_RATE_LIMIT_BURST=200

# Timeouts
NGINX_PROXY_CONNECT_TIMEOUT=60s
NGINX_PROXY_SEND_TIMEOUT=60s
NGINX_PROXY_READ_TIMEOUT=60s

# Circuit Breaker
NGINX_MAX_FAILS=3
NGINX_FAIL_TIMEOUT=30s

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================

# General
APP_NAME=CareForAll
APP_VERSION=1.0.0
APP_DEBUG=true
# Set to false in production!

LOG_LEVEL=INFO
# Options: DEBUG, INFO, WARNING, ERROR, CRITICAL

# CORS Settings
CORS_ORIGINS=http://localhost:3000,http://localhost:8000
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=GET,POST,PUT,PATCH,DELETE,OPTIONS
CORS_ALLOW_HEADERS=*

# =============================================================================
# SECURITY
# =============================================================================

# JWT Configuration (if using authentication)
JWT_SECRET_KEY=your-super-secret-jwt-key-change-in-production
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# API Keys
API_KEY_HEADER=X-API-Key
API_RATE_LIMIT_PER_MINUTE=1000

# Encryption
ENCRYPTION_KEY=your-32-byte-encryption-key-here
# Generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"

# =============================================================================
# CACHING CONFIGURATION
# =============================================================================

# Cache Strategy
CACHE_STRATEGY=multi-level
# Options: redis-only, materialized-view-only, multi-level

# Materialized View Refresh
MATERIALIZED_VIEW_REFRESH_INTERVAL=300
# In seconds (300 = 5 minutes)

# Cache Warming
CACHE_WARMING_ENABLED=true
CACHE_WARMING_CAMPAIGNS=550e8400-e29b-41d4-a716-446655440000

# =============================================================================
# OUTBOX PROCESSOR
# =============================================================================
OUTBOX_POLL_INTERVAL=1
# In seconds

OUTBOX_BATCH_SIZE=100
OUTBOX_MAX_RETRIES=5
OUTBOX_RETRY_BACKOFF=exponential

# =============================================================================
# STATE MACHINE CONFIGURATION
# =============================================================================

# Payment State Transitions
PAYMENT_STATE_TRANSITION_TIMEOUT=300
# In seconds

# Event Ordering
EVENT_TIMESTAMP_TOLERANCE=60
# In seconds - allow events within 60s window

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================

# Async Workers (Uvicorn)
UVICORN_WORKERS=4
UVICORN_HOST=0.0.0.0
UVICORN_RELOAD=true
# Set to false in production!

# Request Limits
MAX_REQUEST_SIZE=10485760
# 10MB in bytes

MAX_UPLOAD_SIZE=52428800
# 50MB in bytes

# Timeouts
REQUEST_TIMEOUT=60
WEBHOOK_TIMEOUT=30

# =============================================================================
# DOCKER CONFIGURATION
# =============================================================================

# Docker Compose
COMPOSE_PROJECT_NAME=api_avengers
COMPOSE_FILE=docker-compose.yml

# Service Replicas
DONATION_SERVICE_REPLICAS=3
PAYMENT_SERVICE_REPLICAS=3
TOTALS_SERVICE_REPLICAS=3
NOTIFICATION_SERVICE_REPLICAS=1

# Restart Policy
RESTART_POLICY=always
# Options: no, always, on-failure, unless-stopped

# =============================================================================
# HEALTH CHECK CONFIGURATION
# =============================================================================
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=10s
HEALTH_CHECK_RETRIES=3
HEALTH_CHECK_START_PERIOD=40s

# =============================================================================
# TESTING CONFIGURATION
# =============================================================================
TEST_DATABASE_URL=postgresql://postgres:postgres@localhost:5432/test_db
TEST_REDIS_URL=redis://localhost:6379/15
TEST_RABBITMQ_URL=amqp://guest:guest@localhost:5672/test

# Load Testing
LOAD_TEST_CONCURRENT_USERS=1000
LOAD_TEST_DURATION=300
# In seconds

# =============================================================================
# CI/CD CONFIGURATION
# =============================================================================
CI_REGISTRY=docker.io
CI_REGISTRY_USER=your_dockerhub_username
CI_REGISTRY_PASSWORD=your_dockerhub_password_or_token

# Image Tags
DOCKER_IMAGE_TAG=latest
DOCKER_IMAGE_PREFIX=careforall

# =============================================================================
# BACKUP & DISASTER RECOVERY
# =============================================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
# Cron format: Daily at 2 AM

BACKUP_RETENTION_DAYS=30
BACKUP_STORAGE_PATH=/backups

# =============================================================================
# FEATURE FLAGS
# =============================================================================
FEATURE_REAL_TIME_TOTALS=false
FEATURE_SMS_NOTIFICATIONS=false
FEATURE_WEBHOOK_NOTIFICATIONS=false
FEATURE_ADVANCED_ANALYTICS=false

# =============================================================================
# EXTERNAL SERVICES (Optional)
# =============================================================================

# Sentry (Error Tracking)
SENTRY_DSN=
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=1.0

# DataDog (APM)
DD_AGENT_HOST=
DD_TRACE_ENABLED=false
DD_SERVICE=careforall-platform

# NewRelic (APM)
NEW_RELIC_LICENSE_KEY=
NEW_RELIC_APP_NAME=CareForAll Platform

# =============================================================================
# PRODUCTION OVERRIDES
# =============================================================================
# Uncomment and set these for production deployment

# ENVIRONMENT=production
# APP_DEBUG=false
# LOG_LEVEL=WARNING

# Use strong passwords
# POSTGRES_PASSWORD=generate_strong_password_here
# REDIS_PASSWORD=generate_strong_password_here
# RABBITMQ_PASSWORD=generate_strong_password_here
# GRAFANA_ADMIN_PASSWORD=generate_strong_password_here

# Use real API keys
# STRIPE_API_KEY=sk_live_real_key_here
# SENDGRID_API_KEY=real_key_here

# Configure production URLs
# CORS_ORIGINS=https://careforall.org,https://www.careforall.org
# GF_SERVER_ROOT_URL=https://monitoring.careforall.org

# =============================================================================
# NOTES
# =============================================================================
# 
# 1. SECURITY: Never commit .env file to version control!
#    Add .env to .gitignore immediately.
#
# 2. PRODUCTION: Change ALL default passwords and API keys before deploying!
#
# 3. DATABASE: Use separate databases per service for true microservices isolation
#
# 4. REDIS: Use different Redis databases (0-15) for different purposes
#
# 5. MONITORING: Ensure observability services are accessible but secured
#
# 6. BACKUP: Set up automated backups for PostgreSQL and Redis
#
# 7. SECRETS: Consider using secret management tools (AWS Secrets Manager,
#    HashiCorp Vault) for sensitive data in production
#
# 8. SCALING: Adjust REPLICAS based on load testing results
#
# 9. TESTING: Keep test environment completely separate from development/production
#
# 10. DOCUMENTATION: Update this file when adding new environment variables
#
# =============================================================================

